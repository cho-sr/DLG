#!/bin/bash
# -*- coding: utf-8 -*-
"""
MIA Sparsification Examples - 다양한 사용 사례

이 파일은 여러 가지 사용 방법을 보여줍니다.
"""

echo "======================================================================="
echo "FedAvg Model Inversion Attack with Gradient Sparsification - EXAMPLES"
echo "======================================================================="

# 예제 1: 기본 사용 (상위 5% 파라미터만 전송)
echo ""
echo "[예제 1] 기본 사용 - 상위 5% 파라미터만 전송"
echo "-----------------------------------------------------------------------"
echo "python fedavg_mia.py --sparsity 0.05 --index 25"
echo ""
echo "설명:"
echo "  - 기본값으로 CIFAR-10 데이터셋의 25번 이미지 사용"
echo "  - 상위 5%의 그래디언트만 공격자에게 전송"
echo "  - 300번의 MIA 최적화 반복 수행"
echo ""

# 예제 2: 다양한 sparsity 비교
echo ""
echo "[예제 2] 다양한 sparsity 비율 비교"
echo "-----------------------------------------------------------------------"
echo "# 프라이버시 수준별 비교"
echo "python fedavg_mia.py --sparsity 1.0 --index 25   # 기준선 (100%)"
echo "python fedavg_mia.py --sparsity 0.1 --index 25   # 약간의 압축 (10%)"
echo "python fedavg_mia.py --sparsity 0.05 --index 25  # 중간 정도 (5%)"
echo "python fedavg_mia.py --sparsity 0.01 --index 25  # 강한 압축 (1%)"
echo ""
echo "설명:"
echo "  - 각 실행마다 다른 sparsity로 공격 난이도 비교"
echo "  - sparsity가 낮을수록 프라이버시 보호 강화"
echo ""

# 예제 3: 배치 실행
echo ""
echo "[예제 3] 배치 실행 - 모든 sparsity 한 번에 실행"
echo "-----------------------------------------------------------------------"
echo "python batch_mia_experiments.py --index 25"
echo ""
echo "설명:"
echo "  - 기본값: 1.0, 0.5, 0.1, 0.05, 0.01 (5가지 sparsity)"
echo "  - 자동으로 순차 실행"
echo "  - 각 실행 결과가 별도 파일로 저장됨"
echo ""

# 예제 4: 커스텀 sparsity 배치 실행
echo ""
echo "[예제 4] 커스텀 sparsity 배치 실행"
echo "-----------------------------------------------------------------------"
echo "python batch_mia_experiments.py --sparsities 1.0 0.2 0.05 0.01 --index 25"
echo ""
echo "설명:"
echo "  - 사용자가 지정한 4가지 sparsity만 테스트"
echo "  - 세밀한 비교 분석을 위해 커스텀 비율 선택 가능"
echo ""

# 예제 5: 더 정교한 실험 설정
echo ""
echo "[예제 5] 더 정교한 실험 설정"
echo "-----------------------------------------------------------------------"
echo "python fedavg_mia.py \\"
echo "  --index 25 \\"
echo "  --sparsity 0.05 \\"
echo "  --mia_iters 500 \\"
echo "  --local_epochs 5 \\"
echo "  --local_lr 0.001 \\"
echo "  --seed 42"
echo ""
echo "설명:"
echo "  - 300 대신 500번 최적화 (더 정교한 복원 시도)"
echo "  - 5 에포크 로컬 학습 (더 많은 학습)"
echo "  - 더 낮은 학습률 (0.001)"
echo "  - 재현 가능한 고정 난수 시드 (42)"
echo ""

# 예제 6: 결과 비교 및 분석
echo ""
echo "[예제 6] 결과 비교 및 시각화 분석"
echo "-----------------------------------------------------------------------"
echo "# 배치 실행 후 비교 분석"
echo "python batch_mia_experiments.py --index 25"
echo "python compare_mia_results.py --sparsities 1.0 0.5 0.1 0.05 0.01"
echo ""
echo "생성 파일:"
echo "  - mia_comparison_tradeoff.png      # 프라이버시-유틸리티 트레이드오프"
echo "  - mia_comparison_compression.png   # 압축 효율성"
echo "  - mia_comparison_difficulty.png    # 공격 난이도"
echo "  - mia_comparison_summary_table.png # 요약 테이블"
echo ""

# 예제 7: 빠른 테스트
echo ""
echo "[예제 7] 시스템 동작 확인 (빠른 테스트)"
echo "-----------------------------------------------------------------------"
echo "python quick_test_mia.py"
echo ""
echo "설명:"
echo "  - 50번 반복만 실행 (빠른 검증)"
echo "  - 3가지 sparsity 테스트 (100%, 10%, 1%)"
echo "  - 전체 파이프라인 확인용"
echo ""

# 예제 8: 다양한 이미지로 강건성 테스트
echo ""
echo "[예제 8] 다양한 이미지로 강건성 테스트"
echo "-----------------------------------------------------------------------"
echo "for idx in 10 25 50 100 150; do"
echo "  python fedavg_mia.py --index \$idx --sparsity 0.05"
echo "done"
echo ""
echo "설명:"
echo "  - 5개의 다른 이미지로 반복 실험"
echo "  - 모델의 일반성 (generalization) 확인"
echo ""

# 예제 9: 프라이버시-성능 최적점 찾기
echo ""
echo "[예제 9] 최적 sparsity 찾기"
echo "-----------------------------------------------------------------------"
echo "python batch_mia_experiments.py \\"
echo "  --sparsities 1.0 0.7 0.5 0.3 0.2 0.1 0.05 0.02 0.01"
echo ""
echo "설명:"
echo "  - 9가지 sparsity로 세밀한 비교"
echo "  - 프라이버시-유틸리티 최적점 찾기"
echo ""

# 예제 10: 성능 최적화 실행
echo ""
echo "[예제 10] 고성능 실험 (GPU 사용)"
echo "-----------------------------------------------------------------------"
echo "python fedavg_mia.py --sparsity 0.05 --mia_iters 1000"
echo ""
echo "설명:"
echo "  - 1000번 최적화 (더 정밀한 복원)"
echo "  - GPU 사용 시 빠른 실행"
echo "  - 높은 정확도 결과"
echo ""

echo ""
echo "======================================================================="
echo "추가 정보"
echo "======================================================================="
echo ""
echo "파일 구조:"
echo "  fedavg_mia.py               - 메인 실행 스크립트"
echo "  batch_mia_experiments.py    - 배치 실행 자동화"
echo "  compare_mia_results.py      - 결과 비교 및 시각화"
echo "  quick_test_mia.py           - 빠른 테스트"
echo "  README_MIA.md               - 상세 설명서"
echo ""

echo "주요 파라미터:"
echo "  --sparsity     : 파라미터 유지 비율 (0.01~1.0)"
echo "  --index        : CIFAR-10 이미지 인덱스"
echo "  --mia_iters    : MIA 최적화 반복 횟수"
echo "  --local_epochs : 로컬 학습 에포크"
echo "  --seed         : 난수 시드 (재현성)"
echo ""

echo "생성 파일:"
echo "  mia_ground_truth.png              - 원본 이미지"
echo "  mia_progress_sparsity_*.png       - 복원 과정"
echo "  mia_loss_sparsity_*.png           - 손실 곡선"
echo "  mia_final_sparsity_*.png          - 최종 결과"
echo "  mia_gradient_dist_sparsity_*.png  - 그래디언트 분포"
echo ""

echo "도움말:"
echo "  python fedavg_mia.py --help                  # 스크립트 도움말"
echo "  python batch_mia_experiments.py --help       # 배치 도움말"
echo "  python compare_mia_results.py --help         # 비교 도움말"
echo ""

echo "======================================================================="
echo "더 자세한 정보는 README_MIA.md를 참조하세요."
echo "======================================================================="
